<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#000000">
  <meta name="mobile-web-app-capable" content="yes">
  <title>Structured - Tagesplaner</title>
  <style>
    * { 
      margin:0; 
      padding:0; 
      box-sizing:border-box; 
      -webkit-tap-highlight-color:transparent; 
      -webkit-user-select:none; 
      user-select:none;
      -webkit-touch-callout: none;
    }
    :root {
      /* Hintergrund - Seriöses Dunkelgrau */
      --bg-primary: #0A0B0D;       /* Sehr dunkles Grau */
      --bg-secondary: #141518;      /* Panels, Modals */
      --glass: rgba(255, 255, 255, 0.03);
      --glass-border: rgba(255, 255, 255, 0.06);

      /* Text */
      --text-primary: #E8E9ED;
      --text-secondary: rgba(232, 233, 237, 0.65);
      --text-tertiary: rgba(232, 233, 237, 0.35);
      
      /* Haupt-Akzent - Professionelles Blau */
      --primary: #4B7BEC;
      --primary-dark: #3867D6;
      
      /* Statusfarben - Gedämpft */
      --success: #26DE81;          /* Professionelles Grün */
      --danger: #FC5C65;           /* Gedämpftes Rot */
      --accent: #778CA3;           /* Neutrales Grau-Blau */
      
      /* Karten-Schatten */
      --shadow-1: 0 4px 12px rgba(0, 0, 0, 0.4);
      --shadow-2: 0 8px 24px rgba(0, 0, 0, 0.5);
      
      /* Icon-Background */
      --icon-bg: rgba(75, 123, 236, 0.12);
      --icon-accent: rgba(75, 123, 236, 0.18);
      
      /* Kategorie-Farben - Professionell (ohne Purple) */
      --cat-blue: #4B7BEC;
      --cat-green: #26DE81;
      --cat-grey: #4A5568;      /* Ersetzt Purple */
      --cat-orange: #FD9644;
      --cat-teal: #00CEC9;      /* Ersetzt Pink */

      /* Category accents (Tasks) - Professionell (ohne Purple) */
      --acc-arbeit: #4B7BEC;
      --acc-haushalt: #26DE81;
      --acc-fitness: #20BF6B;
      --acc-lernen: #4B7BEC;
      --acc-gesundheit: #FC5C65;
      --acc-persoenlich: #4A5568;   /* Grau statt Purple */
      --acc-kreativ: #00CEC9;        /* Teal statt Purple */
      --acc-social: #FD9644;
      --acc-finanzen: #26DE81;
      --acc-technik: #778CA3;

      /* Category accents (Habits) - Professionell (ohne Purple) */
      --acc-morgen: #FD9644;
      --acc-abend: #4A5568;          /* Grau statt Purple */
      --acc-produktiv: #4B7BEC;
      --acc-healthfit: #20BF6B;
      --acc-detox: #4B7BEC;
      --acc-house-small: #778CA3;
      --acc-schlaf: #2D3748;         /* Dunkelgrau statt Purple */
    }

    /* Animated gradient background */
    @keyframes gradientShift {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    @keyframes float {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-20px) rotate(10deg); }
    }
    
    @keyframes slideUp {
      from {
        transform: translateY(30px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    
    @keyframes checkmark {
      0% { transform: scale(0) rotate(-45deg); }
      50% { transform: scale(1.2) rotate(-45deg); }
      100% { transform: scale(1) rotate(-45deg); }
    }

    html,body{
      width:100%;
      height:100%;
      overflow:hidden;
      position:fixed;
      background: var(--bg-primary);
      overscroll-behavior: none;
    }

    body{
      font-family:-apple-system,BlinkMacSystemFont,sans-serif;
      color:var(--text-primary);
      -webkit-font-smoothing:antialiased;
    }

    /* Floating glass orbs - disabled for minimal design */
    .bg-orb { display: none; }

    .app{
      width:100%;
      height:100%;
      display:flex;
      flex-direction:column;
      position: relative;
      z-index: 1;
      padding-top: env(safe-area-inset-top, 20px);
    }

    /* Glass morphism header */
    .header{
      padding-top:env(safe-area-inset-top,20px);
      background: var(--bg-secondary);
      backdrop-filter: blur(10px);
      border-bottom:1px solid var(--glass-border);
      position: relative;
      z-index: 10;
      box-shadow: var(--shadow-1);
    }
    .header::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(236, 72, 153, 0.1));
      pointer-events: none;
    }
    .header-content{
      padding:20px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      position: relative;
    }
    .header h1{
      font-size:32px;
      font-weight:800;
      background: linear-gradient(90deg, #E8E9ED, #A4B0BE);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      filter: none;
    }
    .header-actions{display:flex;gap:12px;}
    .header-nav {
      display: flex;
      align-items: center;
      gap: 8px;
      justify-content: center;
      width: 100%;
      max-width: 800px;
    }
    
    .header-btn{
      min-width:44px;
      height:44px;
      flex: 0 0 auto;
      background: var(--glass);
      backdrop-filter: blur(10px);
      border:1px solid var(--glass-border);
      border-radius:12px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:22px;
      position: relative;
      overflow: hidden;
      cursor: pointer;
    }
    .header-btn::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, transparent, rgba(255,255,255,0.1));
      opacity: 0;
      transition: opacity 0.3s;
    }
    .header-btn:active::before {
      opacity: 1;
    }
    .header-btn:active{
      transform: scale(0.95);
    }

    /* Calendar glass container */
    .calendar-container{
      background: var(--bg-secondary);
      backdrop-filter: blur(8px);
      border-bottom:1px solid var(--glass-border);
      padding:8px;
    }

    /* Date selector with minimal cards */
    .date-selector{
      display:flex;
      gap:8px;
      padding:12px 16px 16px;
      overflow-x:auto;
      -webkit-overflow-scrolling:touch;
      scrollbar-width:none;
      background: transparent;
      padding-top:10px;
    }
    .date-selector::-webkit-scrollbar{display:none;}

    .date-item{
      flex:0 0 auto;
      min-width:68px;
      height:70px;
      padding:10px;
      text-align:center;
      background: transparent;
      backdrop-filter: none;
      border-radius:12px;
      border:1.5px solid rgba(255,255,255,0.06);
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:5px;
      position: relative;
      overflow: hidden;
      transition: all .2s ease;
      cursor: pointer;
    }
    .date-item:hover{
      background: var(--glass);
      border-color: rgba(255,255,255,0.1);
    }
    .date-item::before {
      display: none;
    }
    .date-item:active{
      transform:scale(0.96);
    }
    .date-item.active{
      background: rgba(75, 123, 236, 0.12);
      border-color:var(--primary);
      box-shadow: 0 0 0 1px var(--primary) inset;
    }
    .date-item.today:not(.active){
      border-color: rgba(75, 123, 236, 0.5);
      background: transparent;
      position: relative;
    }
    .date-item.today:not(.active)::after{
      content: '';
      position: absolute;
      bottom: 8px;
      left: 50%;
      transform: translateX(-50%);
      width: 4px;
      height: 4px;
      background: var(--primary);
      border-radius: 50%;
    }
    .date-day{
      font-size:11px;
      font-weight:600;
      opacity:.5;
      text-transform:uppercase;
      letter-spacing: 0.5px;
    }
    .date-num{
      font-size:22px;
      font-weight:700;
      line-height: 1;
    }
    .date-item.active .date-day,
    .date-item.active .date-num{
      color: var(--primary);
      opacity: 1;
    }

    /* Content */
    .content{
      flex:1;
      overflow-y:auto;
      -webkit-overflow-scrolling:touch;
      padding-bottom:120px;
      position: relative;
    }
    .content::-webkit-scrollbar{display:none;}

    /* Atomic Habits Style Time blocks */
    .time-block{
      padding:0 16px;
      margin-bottom:32px;
    }
    
    /* Habits Grid Container */
    .habits-section {
      padding: 0 16px;
      margin-bottom: 32px;
    }
    
    .habits-header {
      margin-bottom: 16px;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .habits-title {
      font-size: 11px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1.5px;
      color: var(--text-tertiary);
    }
    
    .habits-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
      gap: 12px;
    }
    
    .habit-card {
      background: var(--glass);
      border-radius: 16px;
      padding: 16px 12px;
      border: 1px solid var(--glass-border);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
      min-height: 100px;
    }
    
    .habit-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
    }
    
    .habit-card:active {
      transform: scale(0.98);
    }
    
    .habit-card.completed {
      background: rgba(75, 123, 236, 0.1);
      border-color: var(--primary);
    }
    
    .habit-icon {
      font-size: 28px;
      margin-bottom: 4px;
    }
    
    .habit-name {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-primary);
      text-align: center;
      line-height: 1.2;
    }
    
    .habit-streak {
      display: flex;
      align-items: center;
      gap: 4px;
      padding: 2px 6px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      font-size: 11px;
    }
    
    .habit-check {
      position: absolute;
      top: 8px;
      right: 8px;
      width: 18px;
      height: 18px;
      border: 2px solid var(--glass-border);
      border-radius: 50%;
      display: grid;
      place-items: center;
      background: transparent;
      transition: all 0.2s;
    }
    
    .habit-card.completed .habit-check {
      background: var(--primary);
      border-color: var(--primary);
    }
    
    .habit-card.completed .habit-check::after {
      content: '✓';
      color: white;
      font-size: 10px;
      font-weight: bold;
    }
    .time-header{
      margin-bottom:20px;
      padding:0;
      display:flex;
      align-items:center;
      justify-content:space-between;
      position: relative;
    }
    .time-header-title{
      display:flex;
      align-items:baseline;
      gap:12px;
    }
    .time-label{
      font-size:11px;
      font-weight:700;
      text-transform:uppercase;
      letter-spacing:1.5px;
      color:var(--text-tertiary);
    }
    .time-progress{
      display:flex;
      align-items:center;
      gap:16px;
    }
    .progress-stats{
      display:flex;
      flex-direction:column;
      align-items:flex-end;
      gap:2px;
    }
    .progress-percentage{
      font-size:20px;
      font-weight:800;
      color:var(--text-primary);
    }
    .progress-info{
      font-size:11px;
      color:var(--text-tertiary);
      font-weight:600;
      letter-spacing:0.5px;
    }
    .progress-ring{
      width:44px;
      height:44px;
      position:relative;
    }
    .progress-ring svg{
      width:44px;
      height:44px;
      transform:rotate(-90deg);
    }
    .progress-ring-bg{
      fill:none;
      stroke:var(--glass-border);
      stroke-width:3;
    }
    .progress-ring-fill{
      fill:none;
      stroke:var(--success);
      stroke-width:3;
      stroke-linecap:round;
      transition:stroke-dashoffset .5s cubic-bezier(.4,0,.2,1);
    }

    /* Atomic Habits Style Tasks - GRÖSSER */
    .task{
      display:flex;
      align-items:center;
      background: transparent;
      backdrop-filter: none;
      border-radius:0;
      padding:16px 0;
      margin-bottom:0;
      border:none;
      border-bottom:1px solid rgba(255,255,255,0.06);
      min-height:72px;
      position: relative;
      overflow: visible;
      box-shadow: none;
      transition: background .15s ease, opacity .15s ease;
    }
    .task::before {
      display:none;
    }
    .task:last-child{
      border-bottom:none;
    }
    .task:active{
      transform: none;
      background: var(--glass);
    }
    .task.active {
      border-color: transparent;
    }
    .task.completed{
      opacity:.5;
    }
    .task.completed .task-title{
      text-decoration: line-through;
      text-decoration-color: var(--text-tertiary);
      color: var(--text-tertiary);
    }
    .task.completed .task-subtitle{
      text-decoration: line-through;
      text-decoration-color: var(--text-tertiary);
      opacity: 0.5;
    }
    .task.completed .task-time{
      color: var(--text-tertiary);
    }

    /* Minimal time display - GRÖSSER */
    .task-time{
      font-size:14px;
      color:var(--text-tertiary);
      min-width:48px;
      font-weight:600;
      font-variant-numeric: tabular-nums;
    }
    .task-divider{
      display:none;
    }

    /* Atomic dot indicator */
    .task-dot{
      width:6px;
      height:6px;
      border-radius:50%;
      background:var(--text-tertiary);
      margin-right:16px;
      flex-shrink:0;
      transition: all .2s ease;
      opacity: 0.8;
    }
    .task.habit-task .task-dot{
      background:var(--accent);
      box-shadow: 0 0 6px var(--accent);
    }
    .task.completed .task-dot{
      background:var(--success);
      opacity: 0.6;
    }

    /* Clean content layout - GRÖSSER */
    .task-content{
      flex:1;
      display:flex;
      flex-direction:column;
      gap:4px;
    }
    .task-title{
      font-size:17px;
      font-weight:600;
      line-height:1.4;
      color:var(--text-primary);
    }
    .task-subtitle{
      font-size:13px;
      color:var(--text-tertiary);
      font-weight:500;
      line-height:1.3;
    }

    /* Habit streak indicator */
    .task-streak{
      display:none;
      align-items:center;
      gap:4px;
      padding:4px 10px;
      background:var(--glass);
      border-radius:14px;
      margin-right:12px;
    }
    .task.habit-task .task-streak{
      display:flex;
    }
    .streak-icon{
      font-size:14px;
    }
    .streak-count{
      font-size:13px;
      font-weight:700;
      color:var(--text-secondary);
    }

    /* Minimal checkbox - GRÖSSER */
    .task-check{
      width:24px;
      height:24px;
      border:2px solid rgba(255,255,255,0.15);
      border-radius:6px;
      margin-left:16px;
      display:flex;
      align-items:center;
      justify-content:center;
      flex-shrink:0;
      background: transparent;
      backdrop-filter: none;
      transition: all .2s ease;
      cursor: pointer;
    }
    .task-check:active{
      transform: scale(0.85);
    }
    .task-check.checked{
      background:var(--success);
      border-color:var(--success);
      box-shadow: none;
    }
    .task-check.checked::after{
      content:'✓';
      color:white;
      font-size:15px;
      font-weight:700;
    }

    /* Hidden icon for data storage */
    .task-icon{
      display:none;
    }

    .task-actions{
      display:flex;
      gap:8px;
      margin-left:8px;
    }
    .edit-task-btn, .delete-task-btn{
      width:32px;
      height:32px;
      background:var(--glass);
      backdrop-filter: blur(10px);
      border:1px solid var(--glass-border);
      border-radius:8px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:16px;
    }
    .edit-task-btn:active, .delete-task-btn:active{
      transform: scale(0.9);
      opacity: 0.7;
    }

    /* FAB with glass effect */
    .fab{
      position:fixed;
      bottom:calc(100px + env(safe-area-inset-bottom,0px));
      right:20px;
      width:60px;
      height:60px;
      background: var(--primary);
      border:1px solid rgba(255,255,255,0.2);
      border-radius:20px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:32px;
      box-shadow: var(--shadow-2);
      z-index:30;
      color:white;
      transition: background .2s ease;
      cursor: pointer;
    }
    .fab:active{
      background: var(--primary-dark);
      transform:scale(0.9);
    }

    /* Bottom nav with glass */
    .bottom-nav{
      position:fixed;
      bottom:0;
      left:0;
      right:0;
      background:rgba(10, 10, 15, 0.8);
      backdrop-filter:blur(20px) saturate(180%);
      -webkit-backdrop-filter: blur(20px) saturate(180%);
      border-top:1px solid var(--glass-border);
      padding-bottom:env(safe-area-inset-bottom,0px);
      z-index:20;
    }
    .nav-content{
      display:flex;
      justify-content:space-around;
      padding:10px 0;
    }
    .nav-item{
      flex:1;
      display:flex;
      flex-direction:column;
      align-items:center;
      padding:8px;
      gap:4px;
      color:var(--text-tertiary);
      position: relative;
      cursor: pointer;
    }
    .nav-item::before {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle, var(--primary), transparent);
      opacity: 0;
      transition: opacity 0.3s;
    }
    .nav-item.active::before {
      opacity: 0.1;
    }
    .nav-item:active{
      transform:scale(0.95);
    }
    .nav-item.active{color:var(--primary);}
    .nav-icon{font-size:24px;}
    .nav-label{font-size:11px;font-weight:600;}

    /* Empty state */
    .empty-state{
      text-align:center;
      padding:80px 40px;
      color:var(--text-tertiary);
    }
    .empty-icon{font-size:60px;margin-bottom:16px;opacity:.3;}
    .empty-text{font-size:18px;font-weight:600;color:var(--text-secondary);}

    /* Modal with glass morphism */
    .modal{
      position:fixed;
      inset:0;
      background:rgba(0,0,0,0.6);
      backdrop-filter:blur(10px);
      display:none;
      align-items:flex-end;
      z-index:1000;
    }
    .modal.active{display:flex;}
    .modal-content{
      background: var(--bg-secondary);
      backdrop-filter: blur(20px);
      border:1px solid var(--glass-border);
      border-radius:24px 24px 0 0;
      padding:20px;
      padding-bottom:calc(20px + env(safe-area-inset-bottom,0px));
      width:100%;
      max-height:85vh;
      overflow-y:auto;
      position: relative;
    }
    .modal-content::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.05), rgba(236, 72, 153, 0.05));
      border-radius: 24px 24px 0 0;
      pointer-events: none;
    }
    .modal-header{
      font-size:22px;
      font-weight:700;
      margin:16px 0 24px;
      text-align:center;
      position: relative;
    }
    .modal-close{
      position:absolute;
      top:16px;
      right:16px;
      width:36px;
      height:36px;
      background:var(--glass);
      backdrop-filter: blur(10px);
      border:1px solid var(--glass-border);
      border-radius:10px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:24px;
      position: relative;
      z-index: 10;
      cursor: pointer;
    }
    .modal-close:active{
      transform: scale(0.9);
    }

    /* Month/Year bar - FULL WIDTH LAYOUT */
    .month-bar{
      display:flex; 
      align-items:center; 
      justify-content:center; 
      padding: 36px 20px 28px;
      position: relative;
      background: var(--bg-primary);
      border-bottom: none;
      overflow: visible;
      gap: 12px;
    }
    
    .month-bar::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 20%;
      right: 20%;
      height: 1px;
      background: linear-gradient(90deg, 
        transparent 0%, 
        rgba(75, 123, 236, 0.3) 50%, 
        transparent 100%);
    }

    /* Zentraler Datums-Display - FULL WIDTH CARD */
    .date-display {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      position: relative;
      padding: 16px 40px;
      background: linear-gradient(135deg, 
        rgba(75, 123, 236, 0.08) 0%, 
        rgba(75, 123, 236, 0.02) 100%);
      border-radius: 24px;
      border: 1px solid rgba(75, 123, 236, 0.15);
      backdrop-filter: blur(40px);
      box-shadow: 
        0 10px 20px rgba(0, 0, 0, 0.15),
        0 0 40px rgba(75, 123, 236, 0.1),
        inset 0 2px 4px rgba(255, 255, 255, 0.1);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      flex: 0 1 auto;
    }
    
    .date-display:hover {
      transform: translateY(-2px);
      box-shadow: 
        0 24px 48px rgba(0, 0, 0, 0.3),
        0 0 100px rgba(75, 123, 236, 0.2),
        inset 0 2px 4px rgba(255, 255, 255, 0.15);
    }

    .year-display {
      font-size: 10px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 3px;
      color: rgba(75, 123, 236, 0.6);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      position: relative;
      margin-bottom: 2px;
      flex: 0 0 auto;
    }

    #yearText {
      min-width: 50px;
      text-align: center;
      color: rgba(75, 123, 236, 0.8);
      font-size: 11px;
      font-weight: 800;
      transition: all 0.3s ease;
    }

    .year-nav {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .year-btn {
      width: 24px;
      height: 24px;
      border-radius: 12px;
      background: rgba(75, 123, 236, 0.05);
      border: 1px solid rgba(75, 123, 236, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      color: rgba(75, 123, 236, 0.5);
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      opacity: 0.8;
    }

    .year-btn:hover {
      color: var(--primary);
      background: rgba(75, 123, 236, 0.15);
      border-color: rgba(75, 123, 236, 0.3);
      transform: scale(1.2);
      opacity: 1;
      box-shadow: 0 0 12px rgba(75, 123, 236, 0.3);
    }

    .year-btn:active {
      transform: scale(0.92);
      transition: transform 0.05s ease;
    }

    .year-btn svg {
      width: 12px;
      height: 12px;
      stroke-width: 2.5;
    }

    .month-display {
      font-size: 32px;
      font-weight: 900;
      background: linear-gradient(92deg, 
        #ffffff 0%, 
        #4B7BEC 50%, 
        #3867D6 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      letter-spacing: -1px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 24px;
      position: relative;
      text-transform: capitalize;
      margin-top: 4px;
      animation: shimmer 3s ease-in-out infinite;
      background-size: 200% 100%;
      flex: 1;
      max-width: 200px;
    }
    
    @keyframes shimmer {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    /* INTEGRATED Navigation Buttons */
    .nav-btn {
      width: 48px;
      height: 48px;
      border-radius: 24px;
      background: rgba(10, 11, 13, 0.6);
      border: 2px solid rgba(75, 123, 236, 0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      color: rgba(255, 255, 255, 0.6);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      flex-shrink: 0;
      backdrop-filter: blur(20px);
      box-shadow: 
        0 8px 24px rgba(0, 0, 0, 0.4),
        inset 0 1px 2px rgba(255, 255, 255, 0.1);
    }
    
    
    /* Stelle sicher, dass nextMonth Button nicht mit Heute-Button überlappt */
    @media (max-width: 420px) {
      .date-display {
        padding: 16px 24px;
        margin: 0 8px;
      }
      .month-bar {
        padding: 28px 12px 20px;
        gap: 8px;
      }
    }

    .nav-btn::before {
      display: none;
    }

    .nav-btn:hover {
      color: var(--primary);
      transform: scale(1.08) rotate(5deg);
      border-color: var(--primary);
      background: rgba(75, 123, 236, 0.15);
      box-shadow: 
        0 12px 32px rgba(75, 123, 236, 0.3),
        0 0 40px rgba(75, 123, 236, 0.2),
        inset 0 1px 2px rgba(255, 255, 255, 0.2);
    }

    .nav-btn:active {
      transform: scale(0.95);
      transition: transform 0.05s ease;
      box-shadow: 
        0 4px 12px rgba(0, 0, 0, 0.3),
        inset 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    .nav-btn svg {
      width: 22px;
      height: 22px;
      stroke-width: 2;
      filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
    }

    /* Swipe-Indikator Dots - 12 Monate */
    .month-dots {
      display: flex;
      gap: 4px;
      position: absolute;
      bottom: -18px;
      left: 50%;
      transform: translateX(-50%);
      padding: 6px 8px;
      background: rgba(10, 11, 13, 0.8);
      border-radius: 24px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(75, 123, 236, 0.1);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    .month-dot {
      width: 5px;
      height: 5px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.2);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      cursor: pointer;
    }

    .month-dot:hover {
      background: rgba(75, 123, 236, 0.6);
      transform: scale(1.8);
      box-shadow: 0 0 8px rgba(75, 123, 236, 0.4);
    }

    .month-dot.active {
      width: 20px;
      height: 5px;
      border-radius: 3px;
      background: linear-gradient(90deg, var(--primary), var(--primary-dark));
      box-shadow: 0 0 12px var(--primary);
    }

    /* Heute-Button in Navigation */
    .today-btn-nav {
      position: relative;
      width: 44px;
      height: 44px;
      border-radius: 22px;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      border: 2px solid rgba(75, 123, 236, 0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      color: white;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 
        0 8px 24px rgba(75, 123, 236, 0.3),
        inset 0 1px 2px rgba(255, 255, 255, 0.2);
      flex: 0 0 auto;
      margin-left: 8px;
    }
    
    .today-btn-nav:hover {
      transform: scale(1.1);
      box-shadow: 
        0 12px 32px rgba(75, 123, 236, 0.4),
        0 0 40px rgba(75, 123, 236, 0.3);
    }
    
    .today-btn-nav:active {
      transform: scale(0.95);
    }
    
    .today-btn-nav svg {
      width: 20px;
      height: 20px;
    }

    .today-btn-content::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      border-radius: 24px;
      opacity: 0;
      transition: opacity 0.3s ease;
      z-index: -1;
    }

    .today-btn-content:hover {
      color: white;
      transform: scale(1.02);
      border-color: var(--primary);
      box-shadow: 0 4px 12px rgba(75, 123, 236, 0.3);
    }

    .today-btn-content:hover::before {
      opacity: 1;
    }

    .today-btn-content:active {
      transform: scale(0.98);
    }

    .today-indicator {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: currentColor;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.5); opacity: 0.5; }
    }

    /* Swipe Animation */
    @keyframes swipeLeft {
      from { transform: translateX(30px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    @keyframes swipeRight {
      from { transform: translateX(-30px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    .month-display.swipe-left {
      animation: swipeLeft 0.3s ease;
    }

    .month-display.swipe-right {
      animation: swipeRight 0.3s ease;
    }

    /* Year change animation */
    @keyframes yearChange {
      0% { transform: scale(1); }
      50% { transform: scale(1.15); opacity: 0.7; }
      100% { transform: scale(1); opacity: 1; }
    }

    .year-display.changing {
      animation: yearChange 0.3s ease;
    }

    /* Responsive */
    @media (max-width: 420px) {
      .month-bar {
        padding: 16px 16px 16px 16px;
      }
      
      .month-display {
        font-size: 22px;
      }
      
      #yearText {
        font-size: 18px;
      }
      
      .year-display {
        font-size: 16px;
      }
      
      .nav-btn {
        width: 32px;
        height: 32px;
      }
      
      .nav-btn svg {
        width: 16px;
        height: 16px;
      }
      
      .today-btn-content {
        padding: 8px 18px;
        font-size: 12px;
        margin: 12px auto;
      }
    }

    /* Month Picker Modal */
    .month-picker-modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(20px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    
    .month-picker-modal.show {
      display: flex;
      animation: fadeIn 0.3s ease;
    }
    
    .month-picker-content {
      background: var(--bg-secondary);
      border-radius: 28px;
      padding: 32px;
      max-width: 420px;
      width: 90%;
      border: 1px solid rgba(75, 123, 236, 0.2);
      box-shadow: 
        0 32px 80px rgba(0, 0, 0, 0.5),
        0 0 40px rgba(75, 123, 236, 0.1);
      animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .month-picker-title {
      font-size: 24px;
      font-weight: 700;
      background: linear-gradient(135deg, var(--text-primary), var(--primary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 28px;
      text-align: center;
    }
    
    .month-picker-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
    }
    
    .month-picker-item {
      padding: 18px 12px;
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid rgba(255, 255, 255, 0.06);
      border-radius: 16px;
      cursor: pointer;
      text-align: center;
      font-weight: 600;
      font-size: 14px;
      color: var(--text-secondary);
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .month-picker-item:hover {
      background: rgba(75, 123, 236, 0.1);
      border-color: rgba(75, 123, 236, 0.3);
      color: var(--primary);
      transform: scale(1.05);
      box-shadow: 0 4px 12px rgba(75, 123, 236, 0.2);
    }
    
    .month-picker-item.active {
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: white;
      border-color: var(--primary);
      box-shadow: 0 8px 24px rgba(75, 123, 236, 0.3);
    }
    
    /* Tab Navigation Bar */
    .tab-bar {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 80px;
      background: var(--bg-secondary);
      border-top: 1px solid rgba(255, 255, 255, 0.06);
      display: flex;
      align-items: center;
      justify-content: space-around;
      padding: 0 16px;
      padding-bottom: env(safe-area-inset-bottom, 0px);
      z-index: 100;
      backdrop-filter: blur(20px);
    }
    
    .tab-item {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 4px;
      padding: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
    }
    
    .tab-icon {
      width: 24px;
      height: 24px;
      color: var(--text-tertiary);
      transition: all 0.3s ease;
    }
    
    .tab-label {
      font-size: 10px;
      font-weight: 600;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      transition: all 0.3s ease;
    }
    
    .tab-item.active .tab-icon {
      color: var(--primary);
    }
    
    .tab-item.active .tab-label {
      color: var(--primary);
    }
    
    .tab-item:hover .tab-icon,
    .tab-item:hover .tab-label {
      color: var(--text-secondary);
    }
    
    .tab-item.active:hover .tab-icon,
    .tab-item.active:hover .tab-label {
      color: var(--primary);
    }
    
    /* Central Add Button */
    .tab-add-button {
      position: relative;
      margin: 0 -10px;
      margin-bottom: 20px;
    }
    
    /* Add Menu Overlay */
    .add-menu-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(10px);
      z-index: 999;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s;
    }
    
    .add-menu-overlay.active {
      opacity: 1;
      pointer-events: all;
    }
    
    /* Add Menu */
    .add-menu {
      position: absolute;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%) scale(0.8);
      background: var(--surface);
      border-radius: 20px;
      padding: 8px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      opacity: 0;
      transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      z-index: 1000;
      min-width: 240px;
    }
    
    .add-menu.active {
      opacity: 1;
      transform: translateX(-50%) scale(1);
    }
    
    .add-menu-item {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 14px 18px;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
    }
    
    .add-menu-item:hover {
      background: rgba(255, 255, 255, 0.05);
    }
    
    .add-menu-item:active {
      transform: scale(0.98);
    }
    
    .add-menu-item:not(:last-child) {
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }
    
    .add-menu-icon {
      width: 40px;
      height: 40px;
      border-radius: 12px;
      display: grid;
      place-items: center;
      font-size: 20px;
    }
    
    .add-menu-icon.task {
      background: linear-gradient(135deg, #667eea, #764ba2);
    }
    
    .add-menu-icon.habit {
      background: linear-gradient(135deg, #f093fb, #f5576c);
    }
    
    .add-menu-icon.challenge {
      background: linear-gradient(135deg, #fa709a, #fee140);
    }
    
    .add-menu-icon.note {
      background: linear-gradient(135deg, #4facfe, #00f2fe);
    }
    
    .add-menu-text {
      flex: 1;
    }
    
    .add-menu-title {
      color: var(--text-primary);
      font-weight: 600;
      font-size: 16px;
      margin-bottom: 2px;
    }
    
    .add-menu-subtitle {
      color: var(--text-secondary);
      font-size: 12px;
    }
    
    .add-button-inner {
      width: 60px;
      height: 60px;
      border-radius: 30px;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 
        0 8px 24px rgba(75, 123, 236, 0.4),
        0 0 40px rgba(75, 123, 236, 0.2);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border: 3px solid var(--bg-secondary);
    }
    
    .add-button-inner:hover {
      transform: scale(1.1) rotate(90deg);
      box-shadow: 
        0 12px 32px rgba(75, 123, 236, 0.5),
        0 0 60px rgba(75, 123, 236, 0.3);
    }
    
    .add-button-inner:active {
      transform: scale(0.95);
    }
    
    .add-button-inner svg {
      width: 28px;
      height: 28px;
      color: white;
    }
    
    /* Adjust content for tab bar */
    .content {
      padding-bottom: 100px;
    }
    
    /* Desktop */
    @media (min-width: 768px) {
      body {
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .app {
        max-width: 390px;
        max-height: 844px;
        height: 100vh;
        border-radius: 40px;
        overflow: hidden;
        box-shadow: 0 0 60px rgba(99, 102, 241, 0.3);
        border: 8px solid rgba(255,255,255,0.1);
        position: relative;
      }
      .tab-bar {
        border-radius: 0 0 32px 32px;
        max-width: 390px;
      }
    }
  </style>
</head>
<body>
  <div class="bg-orb orb1"></div>
  <div class="bg-orb orb2"></div>

  <!-- Month Picker Modal -->
  <div class="month-picker-modal" id="monthPickerModal" onclick="closeMonthPicker(event)">
    <div class="month-picker-content" onclick="event.stopPropagation()">
      <div class="month-picker-title">Monat auswählen</div>
      <div class="month-picker-grid" id="monthPickerGrid">
        <!-- Wird dynamisch gefüllt -->
      </div>
    </div>
  </div>

  <div class="app">

    <div class="calendar-container">
      <div class="month-bar">
        <div class="header-nav">
          <button class="nav-btn" id="prevMonth" title="Vorheriger Monat">
            <svg viewBox="0 0 24 24" fill="none">
              <path d="M15 18l-6-6 6-6" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
          
          <div class="date-display">
            <div class="year-display" id="yearDisplay">
              <button class="year-btn" id="prevYear" title="Vorheriges Jahr">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M15 18l-6-6 6-6" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
              <span id="yearText">2024</span>
              <button class="year-btn" id="nextYear" title="Nächstes Jahr">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M9 18l6-6-6-6" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
            </div>
            <div class="month-display" id="monthDisplay" onclick="showMonthPicker()" style="cursor: pointer;">
              <span id="monthName">Dezember</span>
            </div>
            <div class="month-dots">
              <span class="month-dot"></span>
              <span class="month-dot"></span>
              <span class="month-dot"></span>
              <span class="month-dot"></span>
              <span class="month-dot"></span>
              <span class="month-dot"></span>
              <span class="month-dot"></span>
              <span class="month-dot"></span>
              <span class="month-dot"></span>
              <span class="month-dot"></span>
              <span class="month-dot"></span>
              <span class="month-dot active"></span>
            </div>
          </div>
          
          <button class="nav-btn" id="nextMonth" title="Nächster Monat">
            <svg viewBox="0 0 24 24" fill="none">
              <path d="M9 18l6-6-6-6" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>
        
        <!-- Heute Button in Navigation -->
        <button class="today-btn-nav" onclick="goToToday()" title="Zu heute springen">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <path d="M12 6v6l4 4"/>
          </svg>
        </button>
      </div>
    </div>

    <div class="date-selector" id="dateSelector"></div>

    <div class="content" id="content">
      <!-- Habits Section -->
      <div class="habits-section">
        <div class="habits-header">
          <div class="habits-title">Tägliche Gewohnheiten</div>
        </div>
        <div class="habits-grid">
          <div class="habit-card" onclick="toggleHabit(this)">
            <div class="habit-check"></div>
            <div class="habit-icon">💧</div>
            <div class="habit-name">Wasser trinken</div>
            <div class="habit-streak">
              <span>🔥</span>
              <span>5</span>
            </div>
          </div>
          <div class="habit-card" onclick="toggleHabit(this)">
            <div class="habit-check"></div>
            <div class="habit-icon">🧘</div>
            <div class="habit-name">Meditation</div>
            <div class="habit-streak">
              <span>🔥</span>
              <span>12</span>
            </div>
          </div>
          <div class="habit-card" onclick="toggleHabit(this)">
            <div class="habit-check"></div>
            <div class="habit-icon">📚</div>
            <div class="habit-name">Lesen</div>
            <div class="habit-streak">
              <span>🔥</span>
              <span>3</span>
            </div>
          </div>
          <div class="habit-card" onclick="toggleHabit(this)">
            <div class="habit-check"></div>
            <div class="habit-icon">🏃</div>
            <div class="habit-name">Sport</div>
            <div class="habit-streak">
              <span>🔥</span>
              <span>7</span>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Demo Content -->
      <div class="time-block">
        <div class="time-header">
          <div class="time-header-title">
            <div class="time-label">Morgen</div>
          </div>
          <div class="time-progress">
            <div class="progress-stats">
              <div class="progress-percentage">67%</div>
              <div class="progress-info">2/3</div>
            </div>
            <div class="progress-ring">
              <svg>
                <circle class="progress-ring-bg" cx="22" cy="22" r="18"></circle>
                <circle class="progress-ring-fill" cx="22" cy="22" r="18"
                  stroke-dasharray="113"
                  stroke-dashoffset="37">
                </circle>
              </svg>
            </div>
          </div>
        </div>
        
        <div class="task">
          <div class="task-time">06:00</div>
          <div class="task-dot" style="background: var(--cat-orange);"></div>
          <div class="task-content">
            <div class="task-title">Aufwachen</div>
            <div class="task-subtitle">Start in den Tag ☀️</div>
          </div>
          <div class="task-check"></div>
        </div>
        
        
        <div class="task">
          <div class="task-time">09:00</div>
          <div class="task-dot" style="background: var(--primary);"></div>
          <div class="task-content">
            <div class="task-title">Meeting</div>
            <div class="task-subtitle">Team Sync • 45 Min</div>
          </div>
          <div class="task-check"></div>
        </div>
        
        <div class="task">
          <div class="task-time">10:30</div>
          <div class="task-dot" style="background: var(--cat-teal);"></div>
          <div class="task-content">
            <div class="task-title">Kaffee</div>
            <div class="task-subtitle">Energieschub • 15 Min</div>
          </div>
          <div class="task-streak">
            <span class="streak-icon">🔥</span>
            <span class="streak-count">5</span>
          </div>
          <div class="task-check"></div>
        </div>
      </div>

      <div class="time-block">
        <div class="time-header">
          <div class="time-header-title">
            <div class="time-label">Nachmittag</div>
          </div>
          <div class="time-progress">
            <div class="progress-stats">
              <div class="progress-percentage">50%</div>
              <div class="progress-info">1/2</div>
            </div>
            <div class="progress-ring">
              <svg>
                <circle class="progress-ring-bg" cx="22" cy="22" r="18"></circle>
                <circle class="progress-ring-fill" cx="22" cy="22" r="18"
                  stroke-dasharray="113"
                  stroke-dashoffset="57">
                </circle>
              </svg>
            </div>
          </div>
        </div>
        
        <div class="task">
          <div class="task-time">12:00</div>
          <div class="task-dot" style="background: var(--cat-green);"></div>
          <div class="task-content">
            <div class="task-title">Mittagspause</div>
            <div class="task-subtitle">Gesundes Essen • 30 Min</div>
          </div>
          <div class="task-check"></div>
        </div>
        
        <div class="task">
          <div class="task-time">15:00</div>
          <div class="task-dot" style="background: var(--primary);"></div>
          <div class="task-content">
            <div class="task-title">Deep Work</div>
            <div class="task-subtitle">Projekt • 2 Std</div>
          </div>
          <div class="task-check"></div>
        </div>
      </div>

      <div class="time-block">
        <div class="time-header">
          <div class="time-header-title">
            <div class="time-label">Abend</div>
          </div>
          <div class="time-progress">
            <div class="progress-stats">
              <div class="progress-percentage">0%</div>
              <div class="progress-info">0/2</div>
            </div>
            <div class="progress-ring">
              <svg>
                <circle class="progress-ring-bg" cx="22" cy="22" r="18"></circle>
                <circle class="progress-ring-fill" cx="22" cy="22" r="18"
                  stroke-dasharray="113"
                  stroke-dashoffset="113">
                </circle>
              </svg>
            </div>
          </div>
        </div>
        
        <div class="task">
          <div class="task-time">18:00</div>
          <div class="task-dot" style="background: var(--cat-green);"></div>
          <div class="task-content">
            <div class="task-title">Workout</div>
            <div class="task-subtitle">Krafttraining • 1 Std</div>
          </div>
          <div class="task-check"></div>
        </div>
        
        <div class="task">
          <div class="task-time">23:00</div>
          <div class="task-dot"></div>
          <div class="task-content">
            <div class="task-title">Schlafen</div>
            <div class="task-subtitle">Gute Nacht 🌙</div>
          </div>
          <div class="task-check" style="pointer-events: none; opacity: 0.5;"></div>
        </div>
      </div>
    </div>
    
    <!-- Tab Navigation Bar -->
    <div class="tab-bar">
      <div class="tab-item active" onclick="switchTab('home')">
        <svg class="tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
          <polyline points="9 22 9 12 15 12 15 22"/>
        </svg>
        <span class="tab-label">Home</span>
      </div>
      
      <div class="tab-item" onclick="switchTab('timeline')">
        <svg class="tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="12" y1="2" x2="12" y2="22"/>
          <circle cx="12" cy="6" r="2"/>
          <circle cx="12" cy="12" r="2"/>
          <circle cx="12" cy="18" r="2"/>
        </svg>
        <span class="tab-label">Timeline</span>
      </div>
      
      <!-- Central Add Button -->
      <div class="tab-add-button" onclick="toggleAddMenu()">
        <div class="add-button-inner" id="addButtonInner">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
            <line x1="12" y1="5" x2="12" y2="19"/>
            <line x1="5" y1="12" x2="19" y2="12"/>
          </svg>
        </div>
      </div>
      
      <div class="tab-item" onclick="switchTab('stats')">
        <svg class="tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="20" x2="18" y2="10"/>
          <line x1="12" y1="20" x2="12" y2="4"/>
          <line x1="6" y1="20" x2="6" y2="14"/>
        </svg>
        <span class="tab-label">Stats</span>
      </div>
      
      <div class="tab-item" onclick="switchTab('settings')">
        <svg class="tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 15a3 3 0 100-6 3 3 0 000 6z"/>
          <path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"/>
        </svg>
        <span class="tab-label">Settings</span>
      </div>
    </div>

  </div>

  <!-- Add Menu Overlay -->
  <div class="add-menu-overlay" id="addMenuOverlay" onclick="closeAddMenu()">
    <div class="add-menu" id="addMenu" onclick="event.stopPropagation()">
      <div class="add-menu-item" onclick="addTask()">
        <div class="add-menu-icon task">✓</div>
        <div class="add-menu-text">
          <div class="add-menu-title">Add Task</div>
          <div class="add-menu-subtitle">Neue Aufgabe hinzufügen</div>
        </div>
      </div>
      <div class="add-menu-item" onclick="addHabit()">
        <div class="add-menu-icon habit">🔥</div>
        <div class="add-menu-text">
          <div class="add-menu-title">Add Habit</div>
          <div class="add-menu-subtitle">Neue Gewohnheit starten</div>
        </div>
      </div>
      <div class="add-menu-item" onclick="addChallenge()">
        <div class="add-menu-icon challenge">⚡</div>
        <div class="add-menu-text">
          <div class="add-menu-title">Add Challenge</div>
          <div class="add-menu-subtitle">Neue Herausforderung</div>
        </div>
      </div>
      <div class="add-menu-item" onclick="addNote()">
        <div class="add-menu-icon note">📝</div>
        <div class="add-menu-text">
          <div class="add-menu-title">Add Note</div>
          <div class="add-menu-subtitle">Notiz hinzufügen</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    let selectedDate = new Date();
    const monthNames = ['Januar','Februar','März','April','Mai','Juni','Juli','August','September','Oktober','November','Dezember'];
    
    function daysInMonth(y, m){ 
      return new Date(y, m+1, 0).getDate(); 
    }
    
    function clampDay(y, m, d){ 
      return Math.min(d, daysInMonth(y,m)); 
    }

    document.addEventListener('DOMContentLoaded', () => {
      updateCalendarDisplay();
      generateDateSelector();
      setupEventListeners();
    });

    function setupEventListeners() {
      // FAB
      document.getElementById('fab').addEventListener('click', () => {
        alert('Modal für neue Aufgabe würde sich öffnen');
      });
      
      // Month/Year navigation
      document.getElementById('prevMonth').addEventListener('click', () => changeMonth(-1));
      document.getElementById('nextMonth').addEventListener('click', () => changeMonth(1));
      document.getElementById('prevYear').addEventListener('click', () => changeYear(-1));
      document.getElementById('nextYear').addEventListener('click', () => changeYear(1));
      
      // Month dots clickable - direkt zu Monat springen
      document.querySelectorAll('.month-dot').forEach((dot, idx) => {
        dot.addEventListener('click', () => {
          const currentYear = selectedDate.getFullYear();
          selectedDate = new Date(currentYear, idx, 1);
          const day = selectedDate.getDate();
          selectedDate.setDate(clampDay(currentYear, idx, day));

          // Animation
          document.getElementById('monthDisplay').classList.add('swipe-left');
          setTimeout(() => {
            document.getElementById('monthDisplay').classList.remove('swipe-left');
          }, 300);
          
          updateCalendarDisplay();
          generateDateSelector();
        });
      });
      
      // Touch/Swipe Support für Monatswechsel
      let touchStartX = 0;
      let touchEndX = 0;
      
      const monthBar = document.querySelector('.month-bar');
      monthBar.addEventListener('touchstart', (e) => {
        touchStartX = e.changedTouches[0].screenX;
      }, {passive: true});
      
      monthBar.addEventListener('touchend', (e) => {
        touchEndX = e.changedTouches[0].screenX;
        handleSwipe();
      }, {passive: true});
      
      function handleSwipe() {
        const swipeThreshold = 50;
        const diff = touchStartX - touchEndX;
        
        if (Math.abs(diff) > swipeThreshold) {
          if (diff > 0) {
            // Swipe left - next month
            changeMonth(1);
            document.getElementById('monthDisplay').classList.add('swipe-left');
          } else {
            // Swipe right - previous month
            changeMonth(-1);
            document.getElementById('monthDisplay').classList.add('swipe-right');
          }
          
          setTimeout(() => {
            document.getElementById('monthDisplay').classList.remove('swipe-left', 'swipe-right');
          }, 300);
        }
      }

      // Task checkboxes with localStorage
      document.querySelectorAll('.task-check').forEach((check, index) => {
        if (check.style.pointerEvents !== 'none') {
          check.addEventListener('click', (e) => {
            e.stopPropagation();
            const task = check.closest('.task');
            const dot = task.querySelector('.task-dot');
            const taskTitle = task.querySelector('.task-title')?.textContent || `task_${index}`;
            const dateKey = `tasks_${selectedDate.toISOString().split('T')[0]}`;
            
            if (check.classList.contains('checked')) {
              check.classList.remove('checked');
              task.classList.remove('completed');
              dot.style.background = 'var(--primary)';
              dot.style.opacity = '0.8';
              
              // Remove from localStorage
              const states = JSON.parse(localStorage.getItem(dateKey) || '{}');
              delete states[taskTitle];
              localStorage.setItem(dateKey, JSON.stringify(states));
            } else {
              check.classList.add('checked');
              task.classList.add('completed');
              dot.style.background = 'var(--success)';
              dot.style.opacity = '0.6';
              
              // Save to localStorage
              const states = JSON.parse(localStorage.getItem(dateKey) || '{}');
              states[taskTitle] = true;
              localStorage.setItem(dateKey, JSON.stringify(states));
              
              // No spring animation - just smooth transition
            }
            
            // Update progress
            updateProgress();
          });
        }
      });
    }

    function loadTaskStates() {
      const dateKey = `tasks_${selectedDate.toISOString().split('T')[0]}`;
      const states = JSON.parse(localStorage.getItem(dateKey) || '{}');
      
      document.querySelectorAll('.task').forEach((task) => {
        const taskTitle = task.querySelector('.task-title')?.textContent;
        const check = task.querySelector('.task-check');
        const dot = task.querySelector('.task-dot');
        
        if (taskTitle && states[taskTitle]) {
          task.classList.add('completed');
          if (check) check.classList.add('checked');
          if (dot) {
            dot.style.background = 'var(--success)';
            dot.style.opacity = '0.6';
          }
        } else {
          task.classList.remove('completed');
          if (check) check.classList.remove('checked');
          if (dot) {
            dot.style.background = 'var(--primary)';
            dot.style.opacity = '0.8';
          }
        }
      });
      
      updateProgress();
    }
    
    function updateProgress() {
      document.querySelectorAll('.time-block').forEach(block => {
        const tasks = block.querySelectorAll('.task');
        const completedTasks = block.querySelectorAll('.task.completed');
        const percentage = Math.round((completedTasks.length / tasks.length) * 100);
        
        block.querySelector('.progress-percentage').textContent = `${percentage}%`;
        block.querySelector('.progress-info').textContent = `${completedTasks.length}/${tasks.length}`;
        block.querySelector('.progress-ring-fill').setAttribute('stroke-dashoffset', 113 - (113 * percentage / 100));
      });
    }

    function updateCalendarDisplay() {
      const y = selectedDate.getFullYear();
      const m = selectedDate.getMonth();
      
      // Update year and month displays
      const yearText = document.getElementById('yearText');
      const monthName = document.getElementById('monthName');
      
      if (yearText) yearText.textContent = y;
      if (monthName) monthName.textContent = monthNames[m];
      
      // Update month dots (12 dots for 12 months)
      const dots = document.querySelectorAll('.month-dot');
      dots.forEach((dot, idx) => {
        dot.classList.remove('active');
        if (idx === m) dot.classList.add('active');
      });

      // Load saved task states for the selected date
      loadTaskStates();
      
      // Heute-Button verstecken wenn bereits heute
      const todayBtn = document.querySelector('.today-btn-nav');
      if (todayBtn) {
        const today = new Date();
        const isSameDay = selectedDate.getDate() === today.getDate() && 
                         selectedDate.getMonth() === today.getMonth() && 
                         selectedDate.getFullYear() === today.getFullYear();
        todayBtn.style.display = isSameDay ? 'none' : 'flex';
      }
    }
    
    // Neue Funktion für Heute-Button
    function goToToday() {
      const today = new Date();
      selectedDate = new Date(today.getFullYear(), today.getMonth(), today.getDate());
      
      // Animation für den Wechsel
      const monthDisplay = document.getElementById('monthDisplay');
      if (monthDisplay) {
        monthDisplay.classList.add('swipe-left');
        setTimeout(() => {
          monthDisplay.classList.remove('swipe-left');
        }, 300);
      }
      
      updateCalendarDisplay();
      generateDateSelector();
      
      // Scroll zum heutigen Tag in der Datumsauswahl
      setTimeout(() => {
        const todayElement = document.querySelector('.date-item.today');
        if (todayElement) {
          todayElement.scrollIntoView({behavior: 'smooth', inline: 'center', block: 'nearest'});
        }
      }, 100);
    }
    
    function changeMonth(delta){
      const y = selectedDate.getFullYear();
      const m = selectedDate.getMonth();
      const d = selectedDate.getDate();
      const newMonth = m + delta;
      const newDate = new Date(y, newMonth, 1);
      
      // Tag beibehalten, aber clampen
      newDate.setDate(clampDay(newDate.getFullYear(), newDate.getMonth(), d));
      selectedDate = newDate;
      
      // Animation trigger
      const monthDisplay = document.getElementById('monthDisplay');
      monthDisplay.classList.add(delta > 0 ? 'swipe-left' : 'swipe-right');
      setTimeout(() => {
        monthDisplay.classList.remove('swipe-left', 'swipe-right');
      }, 300);
      
      updateCalendarDisplay();
      generateDateSelector();
    }

    function changeYear(delta){
      const y = selectedDate.getFullYear() + delta;
      const m = selectedDate.getMonth();
      const d = selectedDate.getDate();
      const newDate = new Date(y, m, 1);
      newDate.setDate(clampDay(y, m, d));
      selectedDate = newDate;
      
      // Animation trigger
      const yearDisplay = document.getElementById('yearDisplay');
      yearDisplay.classList.add('changing');
      setTimeout(() => {
        yearDisplay.classList.remove('changing');
      }, 300);
      
      updateCalendarDisplay();
      generateDateSelector();
    }

    function generateDateSelector() {
      const selector = document.getElementById('dateSelector');
      selector.innerHTML = '';

      const y = selectedDate.getFullYear();
      const m = selectedDate.getMonth();
      const total = daysInMonth(y, m);
      const dayNames = ['So','Mo','Di','Mi','Do','Fr','Sa'];

      for (let day = 1; day <= total; day++) {
        const date = new Date(y, m, day);

        const item = document.createElement('div');
        item.className = 'date-item';
        if (date.toDateString() === new Date().toDateString()) item.classList.add('today');
        if (date.toDateString() === selectedDate.toDateString()) item.classList.add('active');

        item.innerHTML = `
          <div class="date-day">${dayNames[date.getDay()]}</div>
          <div class="date-num">${day}</div>
        `;

        item.addEventListener('click', () => {
          const prev = selector.querySelector('.date-item.active');
          if (prev) prev.classList.remove('active');
          item.classList.add('active');
          selectedDate = date;
          updateCalendarDisplay();
          
          // Update Heute-Button visibility
          const todayBtn = document.querySelector('.today-btn-nav');
          if (todayBtn) {
            const today = new Date();
            const isSameDay = date.getDate() === today.getDate() && 
                             date.getMonth() === today.getMonth() && 
                             date.getFullYear() === today.getFullYear();
            todayBtn.style.display = isSameDay ? 'none' : 'flex';
          }
        });

        selector.appendChild(item);
      }

      // aktive in Sicht scrollen
      setTimeout(() => {
        selector.querySelector('.date-item.active')?.scrollIntoView({behavior:'smooth', inline:'center', block:'nearest'});
      }, 50);
    }
    
    // Tab Navigation Functions
    function switchTab(tabName) {
      // Remove active class from all tabs
      document.querySelectorAll('.tab-item').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Add active class to selected tab
      event.currentTarget.classList.add('active');
      
      // Here you would switch the content based on the tab
      console.log('Switching to tab:', tabName);
      closeAddMenu(); // Close menu when switching tabs
      
      // For now, just show an alert
      if (tabName !== 'home') {
        alert(`${tabName.charAt(0).toUpperCase() + tabName.slice(1)} View - Coming Soon!`);
      }
    }
    
    // Add Menu Functions
    let addMenuOpen = false;
    
    function toggleAddMenu() {
      if (addMenuOpen) {
        closeAddMenu();
      } else {
        openAddMenu();
      }
    }
    
    function openAddMenu() {
      addMenuOpen = true;
      document.getElementById('addMenuOverlay').classList.add('active');
      document.getElementById('addMenu').classList.add('active');
      document.getElementById('addButtonInner').style.transform = 'rotate(45deg)';
    }
    
    function closeAddMenu() {
      addMenuOpen = false;
      document.getElementById('addMenuOverlay').classList.remove('active');
      document.getElementById('addMenu').classList.remove('active');
      document.getElementById('addButtonInner').style.transform = 'rotate(0deg)';
    }
    
    function addTask() {
      closeAddMenu();
      console.log('Add Task clicked');
      // Hier würde das Task-Modal geöffnet
      alert('Task hinzufügen - Modal würde sich öffnen');
    }
    
    function addHabit() {
      closeAddMenu();
      console.log('Add Habit clicked');
      // Hier würde das Habit-Modal geöffnet
      alert('Habit hinzufügen - Modal würde sich öffnen');
    }
    
    function addChallenge() {
      closeAddMenu();
      console.log('Add Challenge clicked');
      // Hier würde das Challenge-Modal geöffnet
      alert('Challenge hinzufügen - Modal würde sich öffnen');
    }
    
    function addNote() {
      closeAddMenu();
      console.log('Add Note clicked');
      // Hier würde das Note-Modal geöffnet
      alert('Notiz hinzufügen - Modal würde sich öffnen');
    }
    
    // Toggle Habit Completion
    function toggleHabit(card) {
      card.classList.toggle('completed');
      
      // Save to localStorage
      const habitName = card.querySelector('.habit-name').textContent;
      const dateKey = `habit_${selectedDate.toISOString().split('T')[0]}_${habitName}`;
      const isCompleted = card.classList.contains('completed');
      
      localStorage.setItem(dateKey, isCompleted);
      
      // Animation
      if (isCompleted) {
        card.style.transform = 'scale(1.05)';
        setTimeout(() => {
          card.style.transform = '';
        }, 200);
      }
    }
    
    // Month Picker Functions
    function showMonthPicker() {
      const modal = document.getElementById('monthPickerModal');
      const grid = document.getElementById('monthPickerGrid');
      const currentMonth = selectedDate.getMonth();
      
      // Clear grid
      grid.innerHTML = '';
      
      // Add months
      monthNames.forEach((month, index) => {
        const item = document.createElement('div');
        item.className = 'month-picker-item';
        if (index === currentMonth) {
          item.classList.add('active');
        }
        item.textContent = month;
        item.onclick = () => selectMonth(index);
        grid.appendChild(item);
      });
      
      modal.classList.add('show');
    }
    
    function closeMonthPicker(event) {
      if (event && event.target === event.currentTarget) {
        document.getElementById('monthPickerModal').classList.remove('show');
      }
    }
    
    function selectMonth(monthIndex) {
      const y = selectedDate.getFullYear();
      const d = selectedDate.getDate();
      selectedDate = new Date(y, monthIndex, clampDay(y, monthIndex, d));
      
      updateCalendarDisplay();
      generateDateSelector();
      closeMonthPicker({ target: document.getElementById('monthPickerModal'), currentTarget: document.getElementById('monthPickerModal') });
    }

  </script>

</body>
</html>